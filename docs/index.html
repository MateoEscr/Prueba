<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Los mejores 6 meses de mi vida</title>
<style>
/* ---------------- Reset y variables ---------------- */
:root{
  --bg:#FFD6E0;
  --accent:#4CAF50;
  --text:#2b2b2b;
  --glass: rgba(255,255,255,0.65);
  --glass-strong: rgba(255,255,255,0.85);
  --card-shadow: 0 8px 24px rgba(0,0,0,0.12);
  --rounded: 14px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: Inter, "Segoe UI", Roboto, Arial, sans-serif;
  background: var(--bg);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  overflow-x:hidden;
  -webkit-touch-callout:none;
}

/* ---------------- Emojis (fondo) ---------------- */
/* z-index bajo para que todo el contenido est√© encima pero no oculten corazones cuando hay transparencia */
#emoji-bg{
  position:fixed;
  inset:0;
  z-index:-2;
  pointer-events:none;
  overflow:hidden;
}
.emoji{
  position:absolute;
  font-size: calc(14px + 1vw);
  opacity:0.08;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.06));
  transform-origin:center;
  animation: float linear infinite;
}
@keyframes float{
  0%{ transform: translateY(110vh) rotate(0deg) }
  100%{ transform: translateY(-10vh) rotate(360deg) }
}

/* ---------------- Loader ---------------- */
#loader{
  position:fixed; inset:0;
  display:flex; align-items:center; justify-content:center; flex-direction:column;
  background: linear-gradient(180deg, rgba(255,214,224,0.98), var(--bg));
  z-index:9999;
  transition:opacity .6s ease, visibility .6s;
  /* se ocultar√° con script tras 2s */
}
#loader.hidden{ opacity:0; visibility:hidden; pointer-events:none; }
#loader span{ font-size:3.2rem; margin-bottom:14px; animation:pulse 1.6s infinite; }
@keyframes pulse{ 0%,100%{ transform:scale(1) } 50%{ transform:scale(1.12) } }

/* ---------------- Confirmaci√≥n (pantalla inicial) ---------------- */
#confirm{
  position:fixed; inset:0;
  display:grid; place-items:center;
  z-index:9998;
  padding:24px;
  background: linear-gradient(180deg, rgba(255,255,255,0.35), rgba(255,255,255,0.15));
  backdrop-filter: blur(6px) saturate(1.05);
}
.confirm-card{
  max-width:520px; width:100%;
  background: linear-gradient(180deg, rgba(255,255,255,0.7), rgba(255,255,255,0.5));
  border-radius:18px;
  padding:22px;
  box-shadow: var(--card-shadow);
  display:flex; flex-direction:column; align-items:center; gap:12px;
}

/* copy */
#confirm h2{ margin:0; font-size:1.4rem; text-align:center; }

/* bot√≥n abrir */
#openBtn{
  margin-top:6px;
  background:var(--accent);
  color:white;
  border:none;
  padding:10px 20px;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
  box-shadow: 0 6px 18px rgba(76,175,80,0.22);
}
#openBtn:hover{ transform:translateY(-2px) }

/* ---------------- Contenido principal ---------------- */
.container{
  max-width:1100px;
  margin:0 auto;
  padding:36px 18px 80px;
  position:relative;
  z-index:1;
}

/* glass header for music + title area */
.header-glass{
  width:100%;
  max-width:820px;
  margin:0 auto 18px;
  background:var(--glass);
  border-radius:14px;
  box-shadow: var(--card-shadow);
  padding:14px;
  display:flex;
  gap:16px;
  align-items:center;
  backdrop-filter: blur(6px);
}

/* m√∫sica (reproductor) */
.music-player{
  margin:0;
  padding:10px;
  background: transparent; /* transparente para dejar ver corazones detr√°s */
  display:flex;
  gap:12px;
  align-items:center;
  width:100%;
}
.music-player img{
  width:64px; height:64px; border-radius:10px;
  flex:0 0 64px;
  transition: transform 0.6s linear;
  box-shadow: 0 8px 20px rgba(0,0,0,0.12);
}
/* rotaci√≥n controlada con clase 'playing' */
.music-player.playing img{ transform: rotate(360deg); animation: rotateCover 6s linear infinite; }
@keyframes rotateCover{ from{ transform:rotate(0) } to{ transform:rotate(360deg)} }

.music-controls{ flex:1; display:flex; flex-direction:column; gap:6px; }
.music-title{ font-weight:700; font-size:0.98rem; }
.music-sub{ font-size:0.86rem; color:rgba(0,0,0,0.55); }

.music-actions{ display:flex; gap:10px; align-items:center; }

/* classy play button */
.play-btn{
  width:46px; height:46px; border-radius:50%;
  display:inline-grid; place-items:center;
  background:linear-gradient(180deg,var(--accent), #2f9c3f);
  color:white; border:none; cursor:pointer;
  box-shadow: 0 8px 20px rgba(76,175,80,0.28), inset 0 -3px 8px rgba(0,0,0,0.08);
  transition: transform .18s ease, box-shadow .18s;
}
.play-btn:hover{ transform:translateY(-3px) }
.play-btn:active{ transform:translateY(0) }

/* progress row style */
.progress-row{ display:flex; align-items:center; gap:10px; width:100%; }
.time{ font-size:0.82rem; color:rgba(0,0,0,0.55); min-width:44px; text-align:center; }

/* styled range */
input[type="range"].music-progress{
  -webkit-appearance:none; appearance:none; height:6px;
  background: linear-gradient(90deg, rgba(76,175,80,0.85), rgba(76,175,80,0.6));
  border-radius:6px; outline:none; flex:1;
}
input[type="range"].music-progress::-webkit-slider-thumb{
  -webkit-appearance:none; width:14px; height:14px; border-radius:50%;
  background:white; box-shadow:0 4px 10px rgba(0,0,0,0.18);
  border: 3px solid var(--accent); margin-top:-4px;
}
input[type="range"].music-progress::-moz-range-thumb{
  width:14px; height:14px; border-radius:50%; background:white; border:3px solid var(--accent);
}

/* ---------------- Title & message ---------------- */
.title-wrap{ text-align:center; margin:18px 0 6px; }
h1{ font-size:1.6rem; margin:0; line-height:1.2; }
p.message{ font-size:1rem; color:rgba(0,0,0,0.6); margin:10px 0 24px }

/* ---------------- Carrusel ---------------- */
.carousel{
  width:100%;
  max-width:820px;
  margin: 10px auto 36px;
  overflow:visible; /* allow image shadow overflow so hearts visible around edges */
  position:relative;
  border-radius:16px;
  padding:8px; /* small padding so background hearts show around images */
}
.carousel-track{
  display:flex;
  transition: transform 0.6s cubic-bezier(.22,.88,.28,1);
  will-change: transform;
  gap:14px;
  padding: 8px;
}
.carousel img{
  width:100%;
  max-width:720px;
  height:420px;
  object-fit:cover; /* cover looks nicer in romantic theme */
  border-radius:12px;
  box-shadow: 0 14px 30px rgba(0,0,0,0.12);
  flex: 0 0 calc(100%); /* each slide full-width inside container */
}

/* arrows placed outside cards */
.arrow{ position:absolute; top:50%; transform:translateY(-50%); z-index:2; }
.arrow-left{ left:6px; }
.arrow-right{ right:6px; }

/* arrow pills */
.arrow button{
  background:var(--glass-strong);
  border-radius:50%; border:none; width:44px; height:44px;
  display:grid; place-items:center; cursor:pointer; box-shadow:var(--card-shadow);
}
.arrow button:hover{ transform:translateY(-3px) }

/* responsive */
@media (max-width:900px){
  .carousel img{ height:320px }
  .music-player img{ width:56px; height:56px }
}
@media (max-width:520px){
  h1{ font-size:1.1rem }
  .carousel img{ height:220px }
  .header-glass{ padding:10px; gap:10px }
  .music-title{ font-size:0.95rem }
}
</style>
</head>
<body>

<!-- EMOJIS FONDO -->
<div id="emoji-bg" aria-hidden="true"></div>

<!-- LOADER -->
<div id="loader">
  <span>üíö</span>
  <div style="font-weight:600; color:#6b2b2b">Cargando algo hecho por el pesado de tu novio...</div>
</div>

<!-- CONFIRM -->
<div id="confirm">
  <div class="confirm-card" role="dialog" aria-modal="true" aria-labelledby="confirm-title">
    <h2 id="confirm-title">√Åbreme si te gustan los takis üíö</h2>

    <!-- Reproductor en confirmaci√≥n -->
    <div class="music-player" id="confirmPlayer" aria-hidden="false">
      <img src="images/portada.JPG" alt="Portada de la canci√≥n" id="coverConfirm">
      <div class="music-controls">
        <div class="music-title">Cancion para acompa√±ar... ü•π</div>
        <div class="music-sub">Pulsa play cuando quieras escuchar</div>

        <div style="height:6px"></div>

        <div class="music-actions" style="align-items:center;">
          <button class="play-btn" id="playBtnConfirm" aria-label="Play/Pause">
            <!-- SVG icon (play) -->
            <svg id="iconConfirm" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M5 3v18l15-9L5 3z" fill="currentColor"/>
            </svg>
          </button>

          <div class="progress-row" style="margin-left:8px;">
            <div class="time" id="timeCurConfirm">0:00</div>
            <input id="progressConfirm" class="music-progress" type="range" min="0" max="100" value="0" aria-label="Progreso de la canci√≥n">
            <div class="time" id="timeDurConfirm">0:00</div>
          </div>
        </div>
      </div>
    </div>

    <button id="openBtn">Abrir</button>
  </div>
</div>

<!-- MAIN CONTENT -->
<div class="container" id="mainContent" style="display:none;">

  <div class="header-glass" role="banner">
    <!-- Reproductor en header (igual funcionalidad) -->
    <div class="music-player" id="mainPlayer">
      <img src="images/portada.JPG" alt="Portada" id="coverMain">
      <div class="music-controls">
        <div class="music-title">Cancion para acompa√±ar... ü•π</div>
        <div class="music-sub">Pulsa play cuando quieras</div>

        <div style="height:6px"></div>

        <div class="music-actions">
          <button class="play-btn" id="playBtnMain" aria-label="Play/Pause">
            <svg id="iconMain" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M5 3v18l15-9L5 3z" fill="currentColor"/>
            </svg>
          </button>

          <div class="progress-row" style="margin-left:8px;">
            <div class="time" id="timeCurMain">0:00</div>
            <input id="progressMain" class="music-progress" type="range" min="0" max="100" value="0" aria-label="Progreso de la canci√≥n">
            <div class="time" id="timeDurMain">0:00</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="title-wrap">
    <h1>¬øTe cre√≠as que el concierto era lo √∫nico que iba a regalarte? (empec√© a hacer esto antes de que comprara las entradas y no se me ha escapado üòã)</h1>
    <p class="message">Cada momento juntos es un recuerdo que quiero guardar para siempre.</p>
  </div>

  <!-- Carrusel -->
  <div class="carousel" id="carousel" aria-roledescription="carousel">
    <div class="arrow arrow-left"><button id="prevBtn" aria-label="Slide anterior">‚Äπ</button></div>
    <div class="carousel-track" id="carouselTrack" role="list">
      <!-- Im√°genes (tus rutas /images exactas) -->
      <img src="images/IMG_8777.jpeg" role="listitem" alt="">
      <img src="images/IMG_7604.jpeg" role="listitem" alt="">
      <img src="images/IMG_7567.jpeg" role="listitem" alt="">
      <img src="images/IMG_7372.jpeg" role="listitem" alt="">
      <img src="images/IMG_5003.jpeg" role="listitem" alt="">
      <img src="images/IMG_1427.jpeg" role="listitem" alt="">
      <img src="images/f52fc0bf-7153-43cc-abdc-201a14e7431c.jpeg" role="listitem" alt="">
      <img src="images/f051fdc8-7e2a-46e3-a65c-d632f135f325.jpeg" role="listitem" alt="">
      <img src="images/bc9a39ed-631b-43f8-9a86-ca373ff34698.jpeg" role="listitem" alt="">
      <img src="images/IMG_1204.jpeg" role="listitem" alt="">
      <img src="images/IMG_1113.jpeg" role="listitem" alt="">
      <img src="images/a35975e2-9ba2-42fe-8fdf-ab06c0f87336.jpeg" role="listitem" alt="">
      <img src="images/IMG_1097.jpeg" role="listitem" alt="">
      <img src="images/894dc007-6d33-4bd4-bef9-0f419769eb58.jpeg" role="listitem" alt="">
      <img src="images/7fa3e78a-31ea-4964-b4c9-bf778241b46a.jpeg" role="listitem" alt="">
      <img src="images/3dafce51-cfde-4746-9112-f214c3e11876.jpeg" role="listitem" alt="">
      <img src="images/31f14a18-3ecf-466d-97f6-350c24dbdbc5.jpeg" role="listitem" alt="">
      <img src="images/IMG_0991.jpeg" role="listitem" alt="">
      <img src="images/IMG_0951.jpeg" role="listitem" alt="">
      <img src="images/IMG_0594.jpeg" role="listitem" alt="">
      <img src="images/IMG_0567.jpeg" role="listitem" alt="">
      <img src="images/IMG_0411.jpeg" role="listitem" alt="">
      <img src="images/IMG_0056.jpeg" role="listitem" alt="">
      <img src="images/2bb2426c-6cda-4f0a-adcf-d5f0ac3bfd09.jpeg" role="listitem" alt="">
      <img src="images/24f8cb99-1774-441a-9c2a-ba494afdbec9.jpeg" role="listitem" alt="">
    </div>
    <div class="arrow arrow-right"><button id="nextBtn" aria-label="Siguiente slide">‚Ä∫</button></div>
  </div>

  <!-- Contador -->
  <div style="max-width:820px;margin:20px auto;text-align:center;">
    <div class="counter" id="contador" aria-live="polite" style="font-weight:700;font-size:1.15rem"></div>
  </div>

  <!-- Timeline -->
  <div class="timeline" id="timeline" style="max-width:820px;margin:0 auto;">
    <div class="event"><span class="date">2 Jul 2025:</span> Empezamos a salir.</div>
    <div class="event"><span class="date">15 Jul 2025:</span> Conoc√≠ a sus padres.</div>
    <div class="event"><span class="date">5 Nov 2025:</span> Primer viaje juntos.</div>
  </div>

</div>

<script>
/* ---------------- Inicial: generar emojis discretos ---------------- */
(function createEmojis(){
  const container = document.getElementById('emoji-bg');
  const count = 30; // menos para performance y elegancia
  const palette = ['üíö','üíö','üíö','üíñ']; // hearts, mostly green
  for(let i=0;i<count;i++){
    const d = document.createElement('div');
    d.className='emoji';
    d.textContent = palette[Math.floor(Math.random()*palette.length)];
    d.style.left = Math.random()*100 + '%';
    d.style.top = Math.random()*100 + '%';
    d.style.opacity = (0.04 + Math.random()*0.08).toString();
    d.style.fontSize = (14 + Math.random()*36) + 'px';
    d.style.animationDuration = (18 + Math.random()*18) + 's';
    d.style.transform = `translateY(0) rotate(${Math.random()*360}deg)`;
    container.appendChild(d);
  }
})();

/* ---------------- Loader hide after 2s ---------------- */
window.addEventListener('load', ()=> {
  setTimeout(()=> {
    document.getElementById('loader').classList.add('hidden');
  }, 2000);
});

/* ---------------- Confirm open ---------------- */
document.getElementById('openBtn').addEventListener('click', ()=>{
  document.getElementById('confirm').style.display = 'none';
  document.getElementById('mainContent').style.display = 'block';
});

/* ---------------- Audio player (no autoplay) ---------------- */
const audio = new Audio("images/musica.mp3");
audio.preload = 'metadata';
audio.loop = false;

const playBtnConfirm = document.getElementById('playBtnConfirm');
const playBtnMain    = document.getElementById('playBtnMain');
const iconConfirm    = document.getElementById('iconConfirm');
const iconMain       = document.getElementById('iconMain');
const coverConfirm   = document.getElementById('coverConfirm');
const coverMain      = document.getElementById('coverMain');

const progressConfirm = document.getElementById('progressConfirm');
const progressMain    = document.getElementById('progressMain');
const timeCurConfirm  = document.getElementById('timeCurConfirm');
const timeDurConfirm  = document.getElementById('timeDurConfirm');
const timeCurMain     = document.getElementById('timeCurMain');
const timeDurMain     = document.getElementById('timeDurMain');

function formatTime(s){
  if(!isFinite(s)) return '0:00';
  const m = Math.floor(s/60);
  const sec = Math.floor(s%60).toString().padStart(2,'0');
  return `${m}:${sec}`;
}

let isPlaying = false;
function updatePlayUI(play){
  isPlaying = play;
  const svgPlay = '<path d="M5 3v18l15-9L5 3z" fill="currentColor"/>'; // triangle
  const svgPause = '<g fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></g>';
  iconConfirm.innerHTML = play ? svgPause : svgPlay;
  iconMain.innerHTML = play ? svgPause : svgPlay;

  // add class to player containers to rotate cover while playing
  document.getElementById('confirmPlayer').classList.toggle('playing', play);
  document.getElementById('mainPlayer').classList.toggle('playing', play);
}

function togglePlayFrom(btn){
  if(audio.paused){
    audio.play().catch(()=>{/* play must be triggered by user interaction ‚Äî we are in click handler so ok */});
    updatePlayUI(true);
  } else {
    audio.pause();
    updatePlayUI(false);
  }
}

/* click handlers (both buttons control same audio) */
playBtnConfirm.addEventListener('click', ()=> togglePlayFrom(playBtnConfirm));
playBtnMain.addEventListener('click', ()=> togglePlayFrom(playBtnMain));

/* sync progress and time displays */
audio.addEventListener('loadedmetadata', ()=>{
  const dur = audio.duration;
  timeDurConfirm.textContent = formatTime(dur);
  timeDurMain.textContent = formatTime(dur);
});
audio.addEventListener('timeupdate', ()=>{
  if(!audio.duration) return;
  const pct = (audio.currentTime / audio.duration) * 100;
  progressConfirm.value = pct;
  progressMain.value = pct;
  timeCurConfirm.textContent = formatTime(audio.currentTime);
  timeCurMain.textContent = formatTime(audio.currentTime);
});

/* seeking */
function seekFrom(rangeEl){
  if(!audio.duration) return;
  const pct = Number(rangeEl.value);
  audio.currentTime = (pct/100) * audio.duration;
}
progressConfirm.addEventListener('input', (e)=> seekFrom(e.target));
progressMain.addEventListener('input', (e)=> seekFrom(e.target));

/* when audio ends update UI */
audio.addEventListener('ended', ()=> updatePlayUI(false));

/* ---------------- Smooth carousel with pointer drag ---------------- */
const track = document.getElementById('carouselTrack');
const slides = Array.from(track.children);
let index = 0;

/* Setup sizes: we want each slide to occupy carousel visible width.
   We'll measure container width and set track transform accordingly. */
const carousel = document.getElementById('carousel');

function updateLayout(){
  // Keep index in range
  index = Math.max(0, Math.min(index, slides.length-1));
  moveToIndex(index, true);
}
function moveToIndex(i, instant){
  const containerWidth = carousel.clientWidth - 16; // account padding
  const offset = i * (containerWidth + 14); // gap =14
  track.style.transition = instant ? 'none' : 'transform 0.6s cubic-bezier(.22,.88,.28,1)';
  track.style.transform = `translateX(-${offset}px)`;
}

/* arrow buttons */
document.getElementById('prevBtn').addEventListener('click', ()=>{
  index = (index-1+slides.length)%slides.length;
  moveToIndex(index,false);
});
document.getElementById('nextBtn').addEventListener('click', ()=>{
  index = (index+1)%slides.length;
  moveToIndex(index,false);
});

/* pointer drag */
let pointerDown = false;
let startX = 0;
let startTranslate = 0;

track.addEventListener('pointerdown', (e)=>{
  pointerDown = true;
  track.setPointerCapture(e.pointerId);
  track.style.transition = 'none';
  startX = e.clientX;
  // extract current translateX
  const m = track.style.transform.match(/translateX\(-?([\d.]+)px\)/);
  startTranslate = m ? parseFloat(m[1]) : 0;
});
track.addEventListener('pointermove', (e)=>{
  if(!pointerDown) return;
  const dx = startX - e.clientX;
  const newTranslate = startTranslate + dx;
  track.style.transform = `translateX(-${newTranslate}px)`;
});
track.addEventListener('pointerup', (e)=>{
  if(!pointerDown) return;
  pointerDown = false;
  track.releasePointerCapture(e.pointerId);
  // decide based on movement whether to change slide
  const dx = startX - e.clientX;
  const threshold = 80;
  if(dx > threshold){ index = Math.min(index+1, slides.length-1); }
  else if(dx < -threshold){ index = Math.max(index-1, 0); }
  moveToIndex(index, false);
});
window.addEventListener('resize', updateLayout);
window.addEventListener('load', ()=> {
  // ensure layout set
  // set track width: sum of slide widths + gaps
  // We'll rely on transform calculations above; call updateLayout
  setTimeout(updateLayout,50);
});

/* allow clicking a slide to center it */
slides.forEach((s, i)=>{
  s.style.cursor = 'pointer';
  s.addEventListener('click', ()=> {
    index = i;
    moveToIndex(index,false);
  });
});

/* ---------------- Counter (Madrid timezone) ---------------- */
const contador = document.getElementById('contador');
// start date 2025-07-02 midnight Madrid (CEST +02:00 in July)
const startDate = new Date('2025-07-02T00:00:00+02:00');

function updateCounter(){
  const now = new Date();
  let diff = Math.floor((now - startDate)/1000);
  const days = Math.floor(diff / 86400);
  diff %= 86400;
  const hours = Math.floor(diff / 3600);
  diff %= 3600;
  const minutes = Math.floor(diff / 60);
  const seconds = diff % 60;
  contador.textContent = `${days} d√≠as ${hours} h ${minutes} m ${seconds} s`;
}
setInterval(updateCounter,1000);
updateCounter();

/* ---------------- Timeline reveal ---------------- */
const events = document.querySelectorAll('.event');
function checkVisibility(){
  const trigger = window.innerHeight * 0.85;
  events.forEach(ev=>{
    const top = ev.getBoundingClientRect().top;
    if(top < trigger) ev.classList.add('visible');
  });
}
window.addEventListener('scroll', checkVisibility);
window.addEventListener('load', checkVisibility);

/* accessibility: keyboard controls for play/seek */
document.addEventListener('keydown', (e)=>{
  if(e.code === 'Space' && (document.activeElement === playBtnMain || document.activeElement === playBtnConfirm)){
    e.preventDefault(); togglePlayFrom();
  }
});
</script>
</body>
</html>